from flask import Blueprint
bp = Blueprint('user', __name__, url_prefix='/user')

@bp.route('/api/check-role', methods=['GET'])
def check_role():
    role = request.cookies.get('role')  # Récupère le rôle stocké dans un cookie
    if not role:
        return jsonify({'role': None, 'message': 'Cookie role introuvable'}), 401

    if role == 'gerant':
        return jsonify({'role': 'gerant', 'message': 'Utilisateur est un gérant'}), 200
    elif role == 'campeur':
        return jsonify({'role': 'campeur', 'message': 'Utilisateur est un campeur'}), 200
    else:
        return jsonify({'role': 'inconnu', 'message': 'Rôle inconnu'}), 403